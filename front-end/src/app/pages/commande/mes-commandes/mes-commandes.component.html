<div class="mes-commandes-page">
  <div class="mes-commandes-header">
    <h1>Mes commandes</h1>
    <p>
      Retrouvez ici le récapitulatif de vos commandes Ahma-Dile,
      leur statut et les différentes étapes jusqu'à la livraison.
    </p>
  </div>

  <div *ngIf="isLoading" class="state state-loading">
    <div class="spinner"></div>
    <p>Chargement de vos commandes...</p>
  </div>

  <div *ngIf="!isLoading && errorMessage" class="state state-error">
    <p>{{ errorMessage }}</p>
    <button type="button" class="btn-primary" (click)="chargerMesCommandes()">
      Réessayer
    </button>
  </div>

  <div *ngIf="!isLoading && !errorMessage && commandes.length === 0" class="state state-empty">
    <i class="fas fa-box-open"></i>
    <h2>Vous n'avez pas encore passé de commande</h2>
    <p>
      Dès que vous passez une commande, vous pourrez suivre ici chaque étape
      jusqu'à la livraison de vos tissus.
    </p>
    <a routerLink="/produits" class="btn-primary">Découvrir les produits</a>
  </div>

  <div *ngIf="!isLoading && !errorMessage && commandes.length > 0" class="commandes-list">
    <div
      class="commande-card"
      *ngFor="let c of commandes"
    >
      <div class="commande-main">
        <div class="commande-ref">
          <span class="label">Commande</span>
          <span class="value">#{{ c.reference || c.id }}</span>
        </div>
        <div class="commande-date">
          <span class="label">Date</span>
          <span class="value">{{ c.date_commande | date: 'dd/MM/yyyy HH:mm' }}</span>
        </div>
        <div class="commande-total">
          <span class="label">Total</span>
          <span class="value">{{ c.total | number:'1.0-0' }} XOF</span>
        </div>
        <div class="commande-statut">
          <span class="label">Statut</span>
          <span class="statut-pill">{{ getStatutLabel(c.statut) }}</span>
        </div>
      </div>

      <div class="commande-steps">
        <p class="etape-description">
          {{ getEtapeDescription(c.statut) }}
        </p>
        <button type="button" class="btn-secondary" (click)="voirDetails(c)">
          Voir le détail & suivre la livraison
        </button>
      </div>
    </div>
  </div>
</div>
